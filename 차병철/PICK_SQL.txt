/* 회원정보 */
DROP TABLE USERS 
	CASCADE CONSTRAINTS;

/* 댓글 */
DROP TABLE COMT 
	CASCADE CONSTRAINTS;

/* 투표권한 */
DROP TABLE VOTE_AUTH 
	CASCADE CONSTRAINTS;

/* 관심사 */
DROP TABLE INTR 
	CASCADE CONSTRAINTS;

/*  투표 */
DROP TABLE VOTE 
	CASCADE CONSTRAINTS;

/* 선택지 */
DROP TABLE CHOI 
	CASCADE CONSTRAINTS;

/* 투표자 */
DROP TABLE USER_VOTE 
	CASCADE CONSTRAINTS;

/* 회원관심사 */
DROP TABLE USER_INTR 
	CASCADE CONSTRAINTS;

/* 회원정보 */
CREATE TABLE USERS (
	USER_NO INTEGER NOT NULL, /* 회원일련번호 */
	USER_NAME VARCHAR2(50), /* 회원이름 */
	USER_PWD VARCHAR2(50) NOT NULL, /* 회원비밀번호 */
	USER_GEND VARCHAR2(20) NOT NULL, /* 회원성별 */
	USER_AGE INTEGER NOT NULL, /* 회원나이 */
	USER_MAIL VARCHAR2(40) NOT NULL, /* 회원이메일 */
	USER_PHOT VARCHAR2(255), /* 회원사진 */
	USER_TYPE VARCHAR2(50) /* 회원유형 */
);

CREATE UNIQUE INDEX PK_USERS
	ON USERS (
		USER_NO ASC
	);

ALTER TABLE USERS
	ADD
		CONSTRAINT PK_USERS
		PRIMARY KEY (
			USER_NO
		);

/* 댓글 */
CREATE TABLE COMT (
	COMT_NO INTEGER NOT NULL, /* 댓글일련번호 */
	VOTE_NO INTEGER NOT NULL, /* 투표일련번호 */
	USER_NO INTEGER NOT NULL, /* 회원일련번호 */
	COMT_CONT CLOB NOT NULL, /* 댓글내용 */
	REG_DATE DATE NOT NULL /* 댓글작성일자 */
);

CREATE UNIQUE INDEX PK_COMT
	ON COMT (
		COMT_NO ASC
	);

ALTER TABLE COMT
	ADD
		CONSTRAINT PK_COMT
		PRIMARY KEY (
			COMT_NO
		);

/* 투표권한 */
CREATE TABLE VOTE_AUTH (
	AUTH_NO INTEGER NOT NULL, /* 투표권한일련번호 */
	VOTE_NO INTEGER NOT NULL, /* 투표일련번호 */
	MALE CHAR(1) NOT NULL, /* 남자 */
	F_MALE CHAR(1) NOT NULL, /* 여자 */
	ONE CHAR(1) NOT NULL, /* 10대 */
	TWO CHAR(1) NOT NULL, /* 20대 */
	THRE CHAR(1) NOT NULL, /* 30대 */
	FOUR CHAR(1) NOT NULL, /* 40대 */
	FIVE CHAR(1) NOT NULL, /* 50대 */
	SIX CHAR(1) NOT NULL /* 60대 */
);

CREATE UNIQUE INDEX PK_VOTE_AUTH
	ON VOTE_AUTH (
		AUTH_NO ASC
	);

ALTER TABLE VOTE_AUTH
	ADD
		CONSTRAINT PK_VOTE_AUTH
		PRIMARY KEY (
			AUTH_NO
		);

/* 관심사 */
CREATE TABLE INTR (
	INTR_NO INTEGER NOT NULL, /* 관심사일련번호 */
	INTR_PHOT VARCHAR2(255) NOT NULL, /* 사진 */
	INTR_CONT CLOB NOT NULL /* 관심사 */
);

CREATE UNIQUE INDEX PK_INTR
	ON INTR (
		INTR_NO ASC
	);

ALTER TABLE INTR
	ADD
		CONSTRAINT PK_INTR
		PRIMARY KEY (
			INTR_NO
		);

/*  투표 */
CREATE TABLE VOTE (
	VOTE_NO INTEGER NOT NULL, /* 투표일련번호 */
	USER_NO INTEGER NOT NULL, /* 회원일련번호 */
	VOTE_CATG VARCHAR2(50) NOT NULL, /* 카테고리 */
	VOTE_TITL VARCHAR2(255) NOT NULL, /* 제목 */
	VOTE_CONT CLOB NOT NULL, /* 내용 */
	VOTE_HITS INTEGER NOT NULL, /* 조회수 */
	END_DATE DATE NOT NULL, /* 종료일 */
	VOTE_TYPE VARCHAR2(50) NOT NULL, /* 투표종류 */
	VOTE_MAX INTEGER NOT NULL /* 선택가능개수 */
);

CREATE UNIQUE INDEX PK_VOTE
	ON VOTE (
		VOTE_NO ASC
	);

ALTER TABLE VOTE
	ADD
		CONSTRAINT PK_VOTE
		PRIMARY KEY (
			VOTE_NO
		);

/* 선택지 */
CREATE TABLE CHOI (
	CHOI_NO INTEGER NOT NULL, /* 선택지일련번호 */
	VOTE_NO INTEGER NOT NULL, /* 투표일련번호 */
	CHOI_PHOT VARCHAR2(255) NOT NULL, /* 사진 */
	CHOT_CONT CLOB NOT NULL, /* 글 */
	CHOT_CNT INTEGER NOT NULL /* 득표수 */
);

CREATE UNIQUE INDEX PK_CHOI
	ON CHOI (
		CHOI_NO ASC
	);

ALTER TABLE CHOI
	ADD
		CONSTRAINT PK_CHOI
		PRIMARY KEY (
			CHOI_NO
		);

/* 투표자 */
CREATE TABLE USER_VOTE (
	USER_NO INTEGER NOT NULL, /* 회원일련번호 */
	VOTE_NO INTEGER NOT NULL /* 투표일련번호 */
);

CREATE UNIQUE INDEX PK_USER_VOTE
	ON USER_VOTE (
		USER_NO ASC,
		VOTE_NO ASC
	);

ALTER TABLE USER_VOTE
	ADD
		CONSTRAINT PK_USER_VOTE
		PRIMARY KEY (
			USER_NO,
			VOTE_NO
		);

/* 회원관심사 */
CREATE TABLE USER_INTR (
	USER_NO INTEGER NOT NULL, /* 회원일련번호 */
	INTR_NO INTEGER NOT NULL /* 관심사일련번호 */
);

CREATE UNIQUE INDEX PK_USER_INTR
	ON USER_INTR (
		USER_NO ASC,
		INTR_NO ASC
	);

ALTER TABLE USER_INTR
	ADD
		CONSTRAINT PK_USER_INTR
		PRIMARY KEY (
			USER_NO,
			INTR_NO
		);

ALTER TABLE COMT
	ADD
		CONSTRAINT FK_VOTE_TO_COMT
		FOREIGN KEY (
			VOTE_NO
		)
		REFERENCES VOTE (
			VOTE_NO
		);

ALTER TABLE COMT
	ADD
		CONSTRAINT FK_USERS_TO_COMT
		FOREIGN KEY (
			USER_NO
		)
		REFERENCES USERS (
			USER_NO
		);

ALTER TABLE VOTE_AUTH
	ADD
		CONSTRAINT FK_VOTE_TO_VOTE_AUTH
		FOREIGN KEY (
			VOTE_NO
		)
		REFERENCES VOTE (
			VOTE_NO
		);

ALTER TABLE VOTE
	ADD
		CONSTRAINT FK_USERS_TO_VOTE
		FOREIGN KEY (
			USER_NO
		)
		REFERENCES USERS (
			USER_NO
		);

ALTER TABLE CHOI
	ADD
		CONSTRAINT FK_VOTE_TO_CHOI
		FOREIGN KEY (
			VOTE_NO
		)
		REFERENCES VOTE (
			VOTE_NO
		);

ALTER TABLE USER_VOTE
	ADD
		CONSTRAINT FK_USERS_TO_USER_VOTE
		FOREIGN KEY (
			USER_NO
		)
		REFERENCES USERS (
			USER_NO
		);

ALTER TABLE USER_VOTE
	ADD
		CONSTRAINT FK_VOTE_TO_USER_VOTE
		FOREIGN KEY (
			VOTE_NO
		)
		REFERENCES VOTE (
			VOTE_NO
		);

ALTER TABLE USER_INTR
	ADD
		CONSTRAINT FK_USERS_TO_USER_INTR
		FOREIGN KEY (
			USER_NO
		)
		REFERENCES USERS (
			USER_NO
		);

ALTER TABLE USER_INTR
	ADD
		CONSTRAINT FK_INTR_TO_USER_INTR
		FOREIGN KEY (
			INTR_NO
		)
		REFERENCES INTR (
			INTR_NO
		);